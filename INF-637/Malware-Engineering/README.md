# Awesome resources of  malware  analysis and countermeasures 
Credits to [rshipp-github](https://github.com/rshipp/awesome-malware-analysis#thanks) and (Harsh shah and Shilpesh trivedi)(https://docs.google.com/spreadsheets/d/13wBzwmfAoEBPUgcYM4CgSoj--xLicPz777IQ6iSUlNk/edit#gid=1407551440).

here i will be mentioning the main tools / notes about the tutorials concerning the field of malware analysis  and detection. 

# 1. Windows Registery format specs :
    these consist of the core functionality of the windows OS  like transaction lof files and backup copies and maintaining the conssitent state in case of any crash . 

    general example :
        - \Windows\System32\Config\SYSTEM 
            - In general , System32 consist of diffrent DLL files which are essential trackers for the diffrent processes interacting with the kernel and other applciations , some of them  robustly being explained in the [Broadcom blog on the topic](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=8996b0d8-6e87-40c5-9192-407ba4f94b31&CommunityKey=841f40c9-372f-44f3-8203-f4ce567fafec&tab=librarydocuments) , 
                
                - specially the aclui.dll which can allow the editing of the registry , thus  there needs to be scrutiny for finding the attack vectors of the APT to maintain the post exploitation. 

                - Also the ADVPACK.DLL is needed for the Msupdate to maintain the registry


            - similarly maintaining the registry hive in order to accumulate modifications of the registry in the transaction. 
##  Why is this important :
            For replaying the forensics investigation , registry files will be essential to investigating the attack routes being compromised to get the root control . some of  ways to use powershell to do this is given [in following](https://www.velocidex.com/blog/html/2018/09/29/detecting_powershell_persistence_with_velociraptor_and_yara.html). Where persistence mechanism has been found out by using Yara and another intreating tools Velociraptor  ,for doing triage for the incident logs. using the modules like "Windows.persistence.Powershell" to scan the file signature access for the diffrent scripts 

            general  syntax for running the command :


            velociraptor.exe artifacts collect Windows.Sys.Users --format json 



## 2. Some of the Malware characterstics and writeup analysis 

 - features : 
    - Propagation Mechanism ( networking protocol , crypto , persistent from firewall etc).

    - Artifacts ( the modules of  OS to be modulated , like  Network traffic , registries )

    - Persistence Systems: how the code logic unpacks and implements its C2C communication . 


## 3. malware characterstics : 
    Anti behavourial analysis : being unpredictable in executing the instructions during the monitoring time by the AV or the SIEM . using techniques like  system call (& hooks) , debugger prevention , exploitation for analysis evasion , sandbox detect & evade , virtual machine detect & evade , debugger detection and evasion ,  





## 4. search engine for obfuscated decoding of the strings : 

https://gchq.github.io/CyberChef/ : get this into mind when ever solving not only the CTF but also the 




























## Yara : the swiss knife for lower level signatures 

    - [ ] read the documentation and using python rules to import the rules and doing the automation analysis. 

    - [ ] 


## MAEC : mitre effort of categorising  and sharing malware related intelligence: 

[cluster diagram](maec_top_level_objects.png)



there are various use cases to be envisioned for analysing the diffrent behaviours , like understanding the feature analysis in conjunction  with the other attacked infrastructure . 


it consist of following ontology of the characterstics :

### 1. capablities :
        higher level abili

## Some miscellneous awesome information 
 - Solving CTF challanges on [linux shell](https://rpis.ec/blog/plaidctf-golfso/).

    - Running the C code before main()
         - Using __ attribute __((constructor))
        void f(void) {
            for(;;) {}
        }


